(function(a){a.fn.fixheadertable=function(b){function d(a,b){if(a.currentStyle){var c=x.currentStyle[b]}else if(window.getComputedStyle){var c=document.defaultView.getComputedStyle(a,null).getPropertyValue(b)}return c}function e(){var b=a("<p/>").addClass("t_fixed_header_scroll_inner");var c=a("<div/>").addClass("t_fixed_header_scroll_outer");c.append(b);a(document.body).append(c);var d=b[0].offsetWidth;c.css("overflow","scroll");var e=b[0].offsetWidth;if(d==e)e=c[0].clientWidth;c.remove();return d-e}function f(b,c){var d={m:1,d:1,y:1970,h:0,i:0,s:0},e,f,g;if(c&&c!==null&&c!==undefined){c=a.trim(c);c=c.split(/[\\\/:_;.\t\T\s-]/);b=b.split(/[\\\/:_;.\t\T\s-]/);var h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"];var i=["am","pm","AM","PM"];var j=function(a,b){if(a===0){if(b==12){b=0}}else{if(b!=12){b+=12}}return b};for(e=0,f=b.length;e<f;e++){if(b[e]=="M"){g=a.inArray(c[e],h);if(g!==-1&&g<12){c[e]=g+1}}if(b[e]=="F"){g=a.inArray(c[e],h);if(g!==-1&&g>11){c[e]=g+1-12}}if(b[e]=="a"){g=a.inArray(c[e],i);if(g!==-1&&g<2&&c[e]==i[g]){c[e]=g;d.h=j(c[e],d.h)}}if(b[e]=="A"){g=a.inArray(c[e],i);if(g!==-1&&g>1&&c[e]==i[g]){c[e]=g-2;d.h=j(c[e],d.h)}}if(c[e]!==undefined){d[b[e].toLowerCase()]=parseInt(c[e],10)}}d.m=parseInt(d.m,10)-1;var k=d.y;if(k>=70&&k<=99){d.y=1900+d.y}else if(k>=0&&k<=69){d.y=2e3+d.y}}return new Date(d.y,d.m,d.d,d.h,d.i,d.s,0)}var c={caption:"",showhide:true,theme:"ui",height:null,width:null,minWidth:null,minWidthAuto:false,colratio:[],whiteSpace:"nowrap",addTitles:false,zebra:false,zebraClass:"ui-state-active",sortable:false,sortedColId:null,sortType:[],dateFormat:"d-m-y",pager:false,rowsPerPage:10,resizeCol:false,minColWidth:100,wrapper:true};var b=a.extend(c,b);return this.each(function(){function A(b){k=a('<div class="headtable ui-state-default" style="margin-right : 0px"></div>');j=k;j.insertBefore(b)}function B(d){var e=a("<colgroup />");if(b.colratio.length==0){var f=null;for(var g=0;g<d;g++){f=a('<col style="width : '+100/d+'%" />');e.append(f);f=null}}else if(b.colratio.length==d){var h=0;for(var g=0;g<d;g++){f=a('<col style="width : '+b.colratio[g]+'px" />');e.append(f);f=null;h+=parseInt(b.colratio[g])}a(c).css("width",h+"px")}return e}function C(c,d,e,h){if(b.sortType.length!=0&&b.sortType.length==g){var i=b.sortType[d];if(i=="float"){getSortKey=function(a){var b=parseFloat(String(a).replace(x,""));return isNaN(b)?0:b}}else if(i=="integer"){getSortKey=function(a){return a?parseFloat(String(a).replace(x,"")):0}}else if(i=="date"){getSortKey=function(a){return f(b.dateFormat,a).getTime()}}else{getSortKey=function(b){if(!b){b=""}return a.trim(String(b).toLowerCase())}}}else{getSortKey=function(b){if(!b){b=""}return a.trim(String(b).toLowerCase())}}w.sort(function(a,b){var c=getSortKey(a[d]);var e=getSortKey(b[d]);return c<e?-1:c>e?1:0});if(e=="DESC"){w.reverse()}b.pager?N(c):D(w,c)}function D(c,d){var e=a("tbody",d);e.children().remove();if(b.zebra){for(var f=0;f<c.length;f++){f%2?tr=a('<tr class="'+b.zebraClass+'"></tr>'):tr=a("<tr></tr>");for(var g in c[f]){tr.append(a('<td class="ui-widget-content"></td>').html(c[f][g]))}e.append(tr)}}else{for(var f=0;f<c.length;f++){tr=a("<tr></tr>");for(var g in c[f]){tr.append(a('<td class="ui-widget-content"></td>').html(c[f][g]))}e.append(tr)}}}function E(b){var c=[];a("tr",b).each(function(b){var d={};a("td",this).each(function(b){d[b]=a(this).html()});c.push(d)});return c}function F(d){m=a('<table class="head"/>').append(o).append(a("thead",d));j.append(m);m.wrap("<div></div>");var e=a("th",m);e.addClass("ui-widget-content ui-state-default");if(b.sortable){var f=null;e.each(function(b){a(this).contents().wrapAll('<div class="ui-sort clearfix"></div>');f=a("div.ui-sort",this);f.click(function(){e.removeClass("ui-state-hover");a(this).parent().removeClass("ui-state-active").addClass("ui-state-hover");a("span.ui-icon",e).remove();if(a(this).hasClass("sortedUp")){C(d,b,"DESC",this);a(this).removeClass("sortedUp").addClass("sortedDown");a(this).append('<span style="display : inline-block; vertical-align : middle" class="ui-icon ui-icon-triangle-1-s"></span>')}else{C(d,b,"ASC",this);a(this).removeClass("sortedDown").addClass("sortedUp");a(this).append('<span style="display : inline-block; vertical-align : middle" class="ui-icon ui-icon-triangle-1-n"></span>')}j[0].scrollLeft=l[0].scrollLeft})});a("div.ui-sort",e).addClass("hover")}if(b.resizeCol&&b.colratio.length==g){e.each(function(b){var c=a('<span class="ui-resize"></span>');a(this).prepend(c);c.mousedown(function(a){i(b,a);return false})});_main_wrapper.mousemove(function(a){if(y){k(a);return false}}).mouseup(function(){if(y){n();return false}return true});function h(b){var c=0,d=a("col",o),e=a("th > span.ui-resize",m)[b],f=l[0].scrollLeft;for(var g=0;g<b;g++){c+=parseInt(d[g].style.width)}return e.offsetLeft+5+c-f}function i(a,b){y={id:a,startX:b.clientX,initTableWidth:Q(),offset:h(a)};z.css({display:"block",height:j.height()+l.height()+2+"px",left:y.offset+"px",cursor:"col-resize"})}function k(c){var d=c.clientX-y.startX;y.newWidth=parseInt(a("col",o)[y.id].style.width)+d;y.newTableWidth=y.initTableWidth+d;if(y.newWidth>parseInt(b.minColWidth)){z.css({left:y.offset+d+"px"})}else{y.newWidth=parseInt(b.minColWidth)}}function n(){a(o.children()[y.id]).css({width:y.newWidth+"px"});a(p.children()[y.id]).css({width:y.newWidth+"px"});var b=y.newTableWidth;m.css({width:b+"px"});a(c).css({width:b+"px"});y=null;z.css({display:"none"});j[0].scrollLeft=l[0].scrollLeft}}}function G(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var a=new Number(RegExp.$1);if(a==7||a==6){return true}else{return false}}}function H(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var a=new Number(RegExp.$1);if(a==8){return true}else{return false}}}function I(c){l=a('<div class="body ui-widget-content"></div>').insertBefore(c).append(c);if(b.height!=null&&!isNaN(parseInt(b.height))){l.css("height",b.height+"px")}p=o.clone();a(c).prepend(p);a("td",c).addClass("ui-widget-content");a(c).wrap("<div></div>");if(b.addTitles==true){a("td",c).each(function(){a(this).attr("title",a(this).text())})}if(b.zebra){a("tr:odd",c).addClass(b.zebraClass)}}function J(c){var d=n;if(G()){d=0}var e=0;if(parseInt(a(c).height())>parseInt(b.height)){e=d;overflow="scroll"}else{e=0;overflow="auto"}if(a.browser.msie&&b.height){e=d;overflow="scroll"}k.css("margin-right",e);return overflow}function K(b,c){var d=w.length;var e=0;if(d<c){e=d}else{e=c}var f=w.slice(0,e);D(f,b);s=Math.ceil(d/c);u=1;t.html("Showing page "+u+" of "+s);l.css("overflow-y",J(b));a("tr:last td",b).css("border-bottom-width","1px")}function L(a){u++;if(u>=s){u=s}N(a)}function M(a){u--;if(u<=1){u=1}N(a)}function N(b){var c=w.length;var d,e=0;d=(u-1)*r;if(c<u*r){e=c}else{e=u*r}var f=w.slice(d,e);D(f,b);t.html("Showing page "+u+" of "+s);l.css("overflow-y",J(b));a("tr:last td",b).css("border-bottom-width","1px")}function O(b,c,d){var e=a('<div class="button ui-state-default '+d+'"><span class="ui-icon '+b+'"> </span></div>');v.append(e);e.mouseover(function(){a(this).addClass("ui-state-hover")}).mousedown(function(){a(this).addClass("ui-state-active")}).mouseup(function(){a(this).removeClass("ui-state-active")}).mouseout(function(){a(this).removeClass("ui-state-active");a(this).removeClass("ui-state-hover")}).click(c)}function P(c){v=a('<div class="pager ui-widget-header ui-corner-bottom ui-widget-content"></div>');_main_wrapper.append(v);O("ui-icon-arrowthickstop-1-e",function(){u=s;N(c)},"ui-corner-right");O("ui-icon ui-icon-arrowthick-1-e",function(){L(c)},"noborder");O("ui-icon ui-icon-arrowthick-1-w",function(){M(c)},"noborder");O("ui-icon-arrowthickstop-1-w",function(){u=1;N(c)},"ui-corner-left noborder");_button_set=a('<div id="'+c.id+'_radio" style="float : left">'+'<input type="radio" id="'+c.id+'_show_10_rows" name="'+c.id+'_radio"/><label for="'+c.id+'_show_10_rows">10</label>'+'<input type="radio" id="'+c.id+'_show_25_rows" name="'+c.id+'_radio"/><label for="'+c.id+'_show_25_rows">25</label>'+'<input type="radio" id="'+c.id+'_show_50_rows" name="'+c.id+'_radio" /><label for="'+c.id+'_show_50_rows">50</label>'+'<input type="radio" id="'+c.id+'_show_100_rows" name="'+c.id+'_radio"/><label for="'+c.id+'_show_100_rows">100</label>'+"</div>");v.append(_button_set);a("#"+c.id+"_show_10_rows",v).click(function(){r=q;K(c,r)});a("#"+c.id+"_show_25_rows",v).click(function(){r=q*2.5;K(c,r)});a("#"+c.id+"_show_50_rows",v).click(function(){r=q*5;K(c,r)});a("#"+c.id+"_show_100_rows",v).click(function(){r=q*10;K(c,r)});t=a('<div class="page_infos"></div>');v.append(t);r=q;a("#"+c.id+"_show_"+b.rowsPerPage+"_rows",v).click();_button_set.buttonset()}function Q(){var a=0;for(var c=0;c<b.colratio.length;c++){a+=parseInt(b.colratio[c])}return a}var c=a(this);var d=null;var g=a("thead th",this).length;var h=a(this).width();var i=null;var j=null;var k=null;var l=null;var m=null;var n=e();var o=B(g);var p=null;var q=10;var r=null;var s=null;var t=null;var u=null;var v=null;var w=null;var x=/[\$,%]/g;var y=null;var z=null;i=a("<div/>").addClass("t_fixed_header ui-state-default default "+b.theme).insertBefore(this).append(this);i.css("border","none").css("font-weight","normal");_main_wrapper=a('<div class="t_fixed_header_main_wrapper ui-widget ui-widget-header '+b.theme+'"></div>');if(b.whiteSpace=="normal"){i.addClass("t_fixed_header_wrap")}A(this);F(this);I(this);if(b.wrapper){var R=i.wrap('<div class="ui-widget ui-widget-content ui-corner-all" style="padding : 5px; font-size : 1em;"></div>').parent()}else{var R=i.wrap("<div></div>").parent()}if(b.width!=null&&!isNaN(parseInt(b.width))&&b.width>0){R.css("width",b.width+"px")}var S=i.detach();var T=a('<div class="t_fixed_header_main_wrapper_child"></div>');_main_wrapper.append(T);T.append(S);R.append(_main_wrapper);if(G()){l.css("margin-bottom",17+"px")}if(b.caption!=""){var U=a('<div class="t_fixed_header_caption ui-widget-header ui-corner-top">'+b.caption+"</div>");_main_wrapper.prepend(U).addClass("ui-corner-all");if(b.showhide){var V=a('<div style="cursor : pointer; display : inline-block; vertical-align : middle; background : none; border : none;" class="ui-state-active"><span class="ui-icon ui-icon-triangle-1-n"> </span></div>');U.append(V);V.click(function(){T.toggle();U.toggleClass("toggle");if(v)v.toggle();a("span",V).toggleClass("ui-icon-triangle-1-s")})}}if(b.sortable||b.pager){w=E(this)}if(b.pager){P(this)}if(b.sortable&&!isNaN(parseInt(b.sortedColId))){var W=a("th",m)[b.sortedColId];a(W).addClass("ui-state-hover");a("div.ui-sort",W).click()}if(b.resizeCol&&b.colratio.length==g){z=a('<div class="ui-resize-ghost ui-widget-header" style="height : '+_main_wrapper.parent().height()+'px"></div>');i.append(z)}l.css("overflow-y",J(this));if(b.minWidth!=null&&!isNaN(parseInt(b.minWidth))&&b.minWidth>0){var X=b.minWidth+"px"}else if(b.minWidthAuto){if(b.colratio.length==g){var X=a(this).width()+"px"}else{var X=h+150+"px"}}j.children().first().css("min-width",X);l.children().first().css("min-width",X);l.scroll(function(){j[0].scrollLeft=l[0].scrollLeft});if(b.colratio.length==g){i.removeClass("default");a(m).css("width",Q()+"px")}})}})(jQuery)